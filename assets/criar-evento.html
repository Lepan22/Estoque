<!DOCTYPE html>
<html>
<head>
  <title>Criar Evento</title>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
</head>
<body>
  <h1>Criar Evento</h1>
  <form id="form-evento">
    <label for="data">Data do Evento:</label>
    <input type="date" id="data" required /><br><br>

    <label for="nomeItem">Nome do Item:</label>
    <input list="lista-produtos" id="nomeItem" name="nomeItem" placeholder="Escolha o produto" required />
    <datalist id="lista-produtos"></datalist><br><br>

    <label for="quantidade">Quantidade:</label>
    <input type="number" id="quantidade" required /><br><br>

    <button type="submit">Salvar Evento</button>
  </form>

  <script>
    // Configuração do Firebase
    const firebaseConfig = {
      apiKey: "SUA_API_KEY",
      authDomain: "controleestoquelepan.firebaseapp.com",
      databaseURL: "https://controleestoquelepan-default-rtdb.firebaseio.com",
      projectId: "controleestoquelepan",
      storageBucket: "controleestoquelepan.appspot.com",
      messagingSenderId: "SENDER_ID",
      appId: "APP_ID"
    };
    firebase.initializeApp(firebaseConfig);

    // Preencher o datalist com produtos cadastrados
    const datalist = document.getElementById('lista-produtos');
    firebase.database().ref('produtos').once('value')
      .then(snapshot => {
        const produtos = snapshot.val();
        for (let key in produtos) {
          const option = document.createElement('option');
          option.value = produtos[key].nome;
          datalist.appendChild(option);
        }
      })
      .catch(error => console.error('Erro ao buscar produtos:', error));

    // Salvar o evento
    const form = document.getElementById('form-evento');
    form.addEventListener('submit', function (e) {
      e.preventDefault();
      const data = document.getElementById('data').value;
      const nomeItem = document.getElementById('nomeItem').value;
      const quantidade = document.getElementById('quantidade').value;

      const evento = {
        data,
        nomeItem,
        quantidade
      };

      firebase.database().ref('eventos').push(evento);
      form.reset();
      alert('Evento cadastrado com sucesso!');
    });
  </script>
</body>
</html>
